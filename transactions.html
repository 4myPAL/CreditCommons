<html lang="en">
<head>
<title>Transactions</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet"
	href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
<script
	src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
<script type="text/javascript" src="web3.js"></script>
<script type="text/javascript" src="bignumber.js"></script>
<script type="text/javascript" src="creditCommons.js"></script>
<script type="text/javascript">
	window.onload = function() {
		document.getElementById('me').innerHTML = "ETH Account: <b>" + coinbase
				+ "<br></b> Credit Commons Member: <b>" + isMember
				+ "</b> Alias: <b>" + myAlias + "<br></b>Group ID: <b>"
				+ myGroupID + "</b> Group Name: <b>" + groupName + "</b>";
		document.getElementById('balance').innerText = myBalance + " "
				+ currencyName;
		document.getElementById('debitLimit').innerText = myDebitLimit + " "
				+ currencyName;
	}

	function transfer() {
		var payee = document.getElementById('payee').value;
		var amount = document.getElementById('amount').value;
		creditCommons.transfer(payee, amount);

	}

	var transfersIncome = creditCommons.Transaction({}, {
		fromBlock : 0,
		toBlock : 'latest'
	}, function(error, result) {
		var row = "";
		transfersRec.watch(function(error, result) {
			row += "<hr/>" + Date(result.args._tTimeStamp) + "<br/>"
			"<b>From</b>" + result.args._sender + "&emsp;"
					+ result.args._senderAmount + "<br/>"
			"<b>Income</b>" + result.args._receiverAmount + "<br/>";
			document.getElementById('listIncomes').innerHTML = row;
		});
	});

	var transfersSpendings = creditCommons.Transaction({}, {
		fromBlock : 0,
		toBlock : 'latest'
	}, function(error, result) {
		var row = "";
		transfersRec.watch(function(error, result) {
			row += "<hr/>" + Date(result.args._tTimeStamp) + "<br/>"
			"<b>To</b>" + result.args._receiver + "&emsp;"
					+ result.args._receiverAmount + "<br/>"
			"<b>Spenditure</b>" + result.args._senderAmount + "<br/>";
			document.getElementById('listSpendings').innerHTML = row;
		});
	});
</script>
<style>
.navbar {
	margin-bottom: 0;
	border-radius: 0;
}
</style>
</head>
<body>
	<nav class="navbar navbar-inverse">
		<div class="container-fluid">
			<div class="navbar-header">
				<a class="navbar-brand" href="http://creditcommons.net/">Credit
					Commons</a>
			</div>
			<ul class="nav navbar-nav">
				<li><a href="index.html">Home</a></li>
				<li class="active"><a href="transactions.html">Transactions</a></li>
				<li><a href="groups.html">Groups</a></li>
				<li><a href="members.html">Members</a></li>
				<li><a href="posts.html">Posts</a></li>
				<li><a href="polls.html">Polls</a></li>
				<li><a href="monetary.html">Monetary</a></li>
			</ul>
		</div>
	</nav>
	<div class="container bg-3 text-center">
		<small><p class="bg-info" id="me"></p></small>
		<div class="row">
			<div class="col-sm-12">
				<form class="form-horizontal" role="form">
					<div class="form-group">
						<div class="col-sm-6">
							<select class="form-control" id="myAccount" onchange="login()">
								<script type="text/javascript">
									var options = "";
									for (i = 0; i < nrAcc; i++) {
										options += "<option>" + accounts[i]
												+ "</option>";
									}
									document.write(options);
								</script>
							</select>
						</div>
					</div>
				</form>
				<h3>Payment</h3>
				<form class="form-horizontal" role="form" id="payData">
					<div class="form-group">
						<label class="control-label col-sm-4" for="balance">My
							Balance:</label>
						<div class="col-sm-4">
							<output class="form-control" id="balance"></output>
						</div>
					</div>
					<div class="form-group">
						<label class="control-label col-sm-4" for="debitLimit">My
							Debit Limit:</label>
						<div class="col-sm-4">
							<output class="form-control" id="debitLimit"></output>
						</div>
					</div>
					<div class="form-group">
						<label class="control-label col-sm-4" for="payee">Payee
							account:</label>
						<div class="col-sm-8">
							<input type="text" class="form-control" id="payee"
								placeholder="Enter payee account">
						</div>
					</div>
					<div class="form-group">
						<label class="control-label col-sm-4" for="amount">Amount:</label>
						<div class="col-sm-4">
							<input type="text" class="form-control" id="amount"
								placeholder="Enter amount">
						</div>
					</div>
				</form>
				<button type="submit" class="btn btn-default" onClick="transfer();">Make
					Payment</button>

				<h3>Transactions</h3>
				<h4>Incomes</h4>
				<div id="listIncomes"></div>
				<h4>Spendings</h4>
				<div id="listSpendings"></div>

			</div>
		</div>
	</div>

	<div class="panel-footer">
		<p>
			<img
				src="https://trancsitu.files.wordpress.com/2014/05/ethereum-logo.png"
				width="20" align="top" /> <i>Powered by ethereum</i>
		</p>
		<a rel="license"
			href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img
			alt="Creative Commons License" style="border-width: 0"
			src="https://i.creativecommons.org/l/by-nc-sa/4.0/80x15.png" /></a><br />This
		work is licensed under a <a rel="license"
			href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Creative
			Commons Attribution-NonCommercial-ShareAlike 4.0 International
			License</a>.
	</div>
</body>
</html>